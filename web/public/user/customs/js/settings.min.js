"use strict";function disableSubmitButton(e){$("#2fa_submit").prop("disabled",!0),$(".spinner").removeClass("d-none"),$("#2fa_submit_text").text(e)}function enableSubmitButton(e){$("#2fa_submit").prop("disabled",!1),$(".spinner").addClass("d-none"),$("#2fa_submit_text").text(e)}function handleSuccess(e){var{twoFaVerificationTypeForResponse:t,twoFa_type:o}=e;$("#twoFaVerificationType").val(t),"google_authenticator"===t?($("#section_2fa_form").addClass("d-none"),$("#section_2fa_verify").addClass("d-none"),$("#section_google2fa").removeClass("d-none"),$("#qrsecret").html(e.secret).addClass("d-none"),$("#qr_image").attr("src",e.QR_Image)):"disabled"===t?($("#section_2fa_form").removeClass("d-none"),$("#section_2fa_verify").addClass("d-none"),$("#twoFaVerificationType").val(e.twoFaVerificationTypeForResponse),showSwal(successText,successMessageText,"success")):($("#section_2fa_form").addClass("d-none"),$("#section_2fa_verify").removeClass("d-none"),$("#type").html(o))}function handleError(e){let t;"email"===e.two_step_verification_type?t="2-FA is already set by email!":"phone"===e.two_step_verification_type?t="2-FA is already set by phone!":"google_authenticator"===e.two_step_verification_type&&(t="2-FA is already set by Google Authenticator!"),showSwal(errorText,t,"error")}function showSwal(e,t,o){swal({title:e,text:t,type:o})}function showSwal(e,t,o){swal({title:e,text:t,type:o})}$(".main-containt").find("#twofaVerification").length&&($(document).on("ready",function(){$("#two_step_verification_type").change(function(){"phone"==$(this).val()?$.post({url:twofaVerifyPhoneUrl,data:{_token:token},beforeSend:function(){$("#2fa_submit").prop("disabled",!1)}}).done(function(e){e.status?($("#2fa-error").text(""),$("#2fa_submit").prop("disabled",!1)):($("#2fa-error").text(e.message),$("#2fa_submit").prop("disabled",!0))}):($("#2fa-error").text(""),$("#2fa_submit").prop("disabled",!1))})}),$("#2fa_update").on("submit",function(e){var t;e.preventDefault(),"true"===$("#is_demo").val()?showSwal(errorText,demoCheckText,"error"):(e="google_authenticator"===(t=$("#two_step_verification_type").val())?twofaVerifyGoogleUrl:"disabled"===t?twofaVerifyDisabledUrl:twofaVerifyCreateUrl,$.post({url:e,dataType:"json",data:{_token:token,two_step_verification_type:t},beforeSend:function(){disableSubmitButton(submitBtnText)}}).done(function(e){(e.status?handleSuccess:handleError)(e)}).always(function(){enableSubmitButton("Submit")}))}),$("#2fa_verify_form").on("submit",function(e){e.preventDefault();var o=$("#twoFaVerificationType").val(),n=$("#two_step_verification_code").val(),i=$("#remember_me").prop("checked");(new Fingerprint2).get(function(e,t){$.post({url:twofaVerifySettingsUrl,data:{_token:token,two_step_verification_code:n,twoFaVerificationType:o,remember_me:i,browser_fingerprint:e},beforeSend:function(){$("#verify_code").prop("disabled",!0),$(".spinner").removeClass("d-none"),$("#verify_code_text").text(submitBtnText)}}).fail(function(e,t,o){e=e.responseJSON;e.status&&404!=e.status||showSwal(errorText,e.message,"error")}).done(function(e){e.status?($("#section_2fa_form").removeClass("d-none"),$("#section_2fa_verify").addClass("d-none"),showSwal(successText,e.message,"success"),$("#two_step_verification_code").val("")):showSwal(errorText,e.message,"error"),$("#verify_code").prop("disabled",!1),$(".spinner").addClass("d-none"),$("#verify_code_text").text("Verify")})})}),$(document).on("click",".completeVerification",function(){var e=$("#qrsecret").html();const t=$("#section_2fa_form"),o=$("#section_2fa_verify"),n=$("#section_google2fa"),i=$("#section_2fa_otp");$.post({url:twofaVerifyCompleteGoogleUrl,data:{_token:token,google2fa_secret:e},dataType:"json",beforeSend:function(){$("#completeVerificationBtn").prop("disabled",!0),$(".spinner").removeClass("d-none"),$("#completeVerification_text").text(submitBtnText)}}).done(function(e){e.status&&(t.addClass("d-none"),o.addClass("d-none"),n.addClass("d-none"),i.removeClass("d-none")),$("#completeVerificationBtn").prop("disabled",!1),$(".spinner").addClass("d-none"),$("#completeVerification_text").text("Submit")}).fail(function(e,t,o){console.log("Error:",o)})}),$("#otp_form").on("submit",function(e){e.preventDefault();var o=$("#one_time_password").val(),n=$("#two_step_verification_type").val(),i=$("#remember_otp").is(":checked");(new Fingerprint2).get(function(e,t){$.post({url:twofaVerifyGoogleOtpUrl,dataType:"json",data:{_token:token,one_time_password:o,two_step_verification_type:n,remember_otp:i,browser_fingerprint:e},beforeSend:function(){$("#verify_otp").prop("disabled",!0),$(".spinner").removeClass("d-none"),$("#verify_otp_text").text(submitBtnText)}}).done(function(e){e.status?($("#section_2fa_form").removeClass("d-none"),$("#section_2fa_verify").addClass("d-none"),$("#section_google2fa").addClass("d-none"),$("#section_2fa_otp").addClass("d-none"),showSwal(successText,e.message,"success"),$("#one_time_password").val("")):showSwal(errorText,oneTimeMessageText,"error"),$("#verify_otp").attr("disabled",!1),$(".spinner").addClass("d-none"),$("#verify_otp_text").text("Proceed To Verification")})})})),$(".main-containt").find("#2faVerification").length&&$("#2faVerificationForm").on("submit",function(e){e.preventDefault();var o=$("#two_step_verification_code").val(),n=$("#remember_me").prop("checked");(new Fingerprint2).get(function(e,t){$.post({url:twofaVerifyUrl,dataType:"json",data:{_token:token,two_step_verification_code:o,remember_me:n,browser_fingerprint:e},beforeSend:function(){$("#2faVerifyCode").prop("disabled",!0),$(".spinner").removeClass("d-none"),$("#2faVerifyCode_text").text(submitBtnText)}}).done(function(e){e.status&&404!=e.status?($("#message").text(""),window.location.href=dashboardUrl):($("#message").html(e.message),$("#2faVerifyCode").prop("disabled",!1),$(".spinner").addClass("d-none"),$("#2faVerifyCode_text").text(btnText))})})}),$(".main-containt").find("#google2faVerifySection").length&&($(document).on("click",".completeVerification",function(e){e.preventDefault(),$.post({url:twofaVerifyGoogleAuthenticatorUrl,dataType:"json",data:{_token:token,google2fa_secret:google2fa_secret},beforeSend:function(){$("#completeVerificationBtn").prop("disabled",!0),$(".spinner").removeClass("d-none"),$("#completeVerification_text").text(submitBtnText)}}).done(function(e){e.status&&($("#google2faVerify").addClass("d-none"),$("#section_2fa_otp").removeClass("d-none")),$("#completeVerificationBtn").prop("disabled",!1),$(".spinner").addClass("d-none"),$("#completeVerification_text").text("Submit")})}),$("#otp_form").submit(function(e){e.preventDefault();var o=$("#one_time_password").val(),n=$("#two_step_verification_type").val(),i=$("#remember_me").prop("checked");(new Fingerprint2).get(function(e,t){$.post({url:twofaVerifyGoogleOtpUrl,dataType:"json",data:{_token:token,one_time_password:o,two_step_verification_type:n,remember_otp:i,browser_fingerprint:e},error:function(e){200!=e.status&&showSwal(errorText,JSON.parse(e.responseText).message,"error")},beforeSend:function(){$("#verify_otp").prop("disabled",!0),$(".spinner").removeClass("d-none")}}).done(function(e){e.status?window.location.href=dashboardUrl:showSwal(errorText,invalidCodeText,"error")})})}));